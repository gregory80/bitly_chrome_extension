<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" manifest="cache-manifest">

<!-- MIME TYPE Guidlines and references: http://hixie.ch/advocacy/xhtml -->
    <head>
        <title>bit.ly notification</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="keywords" content="awesome" />
        <meta name="description" content="" />
        <link rel="stylesheet" href="css/basic.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />   
        <link rel="stylesheet" href="css/notifications.css" type="text/css" charset="utf-8" />                        
    </head>
    <body>
        <div id="container">
            <div id="containerInner">
                <div id="footer">
                    <h1><a class="trendsPage" href="#">Trending: </a></h1>
                </div>
                <div id="note_contents_box">

                </div>
                <div id="bit_fish">
                    <img src="s/graphics/bitly_fish_48.png" border="0" height="48" width="48" alt="" />
                </div>
            </div>
        </div> <!-- end #container -->

        <script type="text/javascript" src="js/libs/common.js" charset="utf-8"></script>
        <script type="text/javascript" charset="utf-8">
            
            var bg = chrome.extension.getBackgroundPage(),
                notification_data = bg.get_latest_notifications(),
                latest = notification_data && notification_data.shift(), html = "";
            if(!latest) {
                note_contents_box.innerHTML = "Oops, Sorry but an error happened"
            }
            console.log(notification_data);
            html += "<div class='note_headline'>";
                html += escaper(latest.title || latest.long_url)
            html += "</div>";
            // html += "<div>"
            //     html += latest.long_url
            // html += "</div>"           
            //html += "Past Hour: " + latest.trend_clicks;
            html += '<h4>Total clicks</h4>';
            html += commify( latest.user_clicks );
            html += "<div>of</div>"; 
            html += commify( latest.global_clicks );
            
            var trend_link = document.querySelector(".trendsPage");
            trend_link.addEventListener('click', function(e) {
                e.preventDefault();
                bg.get_chrome_page("trending.html");
            });
            trend_link.innerHTML = "Trending Bit: " + commify(latest.trend_clicks) + " clicks";
            note_contents_box.innerHTML = html;
            bg.remove_notification();
            // now remove it from list...
        </script>

      
    </body>
</html>
